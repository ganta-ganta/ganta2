<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advertisement</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .ganta-ad-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 15px;
        }
        .ganta-ad-card {
            border: none;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            height: 100%;
        }
        .ganta-ad-card:hover {
            transform: translateY(-5px);
        }
        .ganta-ad-img {
            height: 180px;
            object-fit: cover;
            width: 100%;
        }
        .ganta-ad-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
        }
        .ganta-ad-footer {
            font-size: 0.8rem;
            color: #6c757d;
        }
        .carousel-controls {
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.3);
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.8;
        }
        .carousel-controls:hover {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Ad Display Container -->
    <div class="ganta-ad-container">
        <div id="gantaAdCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner" id="gantaAdCarouselInner">
                <!-- Loading placeholder -->
                <div class="carousel-item active text-center py-4">
                    <div class="spinner-border text-primary"></div>
                    <p class="mt-2">Loading advertisements...</p>
                </div>
            </div>
            
            <!-- Navigation controls -->
            <button class="carousel-control-prev carousel-controls" type="button" data-bs-target="#gantaAdCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            </button>
            <button class="carousel-control-next carousel-controls" type="button" data-bs-target="#gantaAdCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
            </button>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Ad Display Script -->
    <script>
        // Configuration
        const gantaAdConfig = {
            adServer: 'https://gantasolutions.com/ads.html',
            clientId: 'PUB_' + Math.floor(Math.random() * 1000000),
            rotationInterval: 8000, // 8 seconds
            maxAds: 4,
            defaultAd: {
                image: 'https://gantasolutions.com/img/ad1.jpg',
                title: 'Special Offer',
                description: 'Check out our premium products',
                url: 'https://gantasolutions.com',
                sponsor: 'GantaSolutions'
            }
        };

        // Initialize when DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            loadGantaAds();
            
            // Set up periodic refresh (every 2 minutes)
            setInterval(loadGantaAds, 120000);
        });

        // Main function to load ads
        function loadGantaAds() {
            fetch(`${gantaAdConfig.adServer}?client=${gantaAdConfig.clientId}&limit=${gantaAdConfig.maxAds}`)
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(ads => {
                    if (!ads || !Array.isArray(ads) || ads.length === 0) {
                        throw new Error('No ads received');
                    }
                    displayGantaAds(ads);
                })
                .catch(error => {
                    console.warn('Failed to load ads:', error.message);
                    displayDefaultGantaAd();
                });
        }

        // Display fetched ads
        function displayGantaAds(ads) {
            const carouselInner = document.getElementById('gantaAdCarouselInner');
            carouselInner.innerHTML = '';
            
            ads.forEach((ad, index) => {
                const item = document.createElement('div');
                item.className = `carousel-item ${index === 0 ? 'active' : ''}`;
                item.innerHTML = `
                    <div class="row justify-content-center">
                        <div class="col-md-10 col-lg-8">
                            <div class="card ganta-ad-card">
                                <span class="ganta-ad-badge">Sponsored</span>
                                <img src="${ad.image || gantaAdConfig.defaultAd.image}" 
                                     class="ganta-ad-img" 
                                     alt="${ad.title || ''}" 
                                     loading="lazy">
                                <div class="card-body">
                                    <h5 class="card-title">${ad.title || gantaAdConfig.defaultAd.title}</h5>
                                    <p class="card-text">${ad.description || gantaAdConfig.defaultAd.description}</p>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <a href="${ad.url || gantaAdConfig.defaultAd.url}" 
                                           class="btn btn-primary btn-sm"
                                           onclick="trackGantaClick('${ad.id || 'default'}')"
                                           target="_blank"
                                           rel="noopener noreferrer">
                                            Learn More
                                        </a>
                                        <small class="ganta-ad-footer">
                                            ${ad.sponsor ? 'Sponsored by ' + ad.sponsor : ''}
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                carouselInner.appendChild(item);
                trackGantaImpression(ad.id || 'default');
            });
            
            // Initialize or refresh carousel
            if (window.gantaCarousel) {
                window.gantaCarousel.dispose();
            }
            window.gantaCarousel = new bootstrap.Carousel(
                document.getElementById('gantaAdCarousel'), {
                    interval: gantaAdConfig.rotationInterval
                }
            );
        }

        // Display single default ad
        function displayDefaultGantaAd() {
            displayGantaAds([gantaAdConfig.defaultAd]);
        }

        // Tracking functions
        function trackGantaImpression(adId) {
            const data = {
                type: 'impression',
                adId: adId,
                clientId: gantaAdConfig.clientId,
                timestamp: new Date().toISOString(),
                url: window.location.href
            };
            
            // Using sendBeacon for reliable tracking
            navigator.sendBeacon(`${gantaAdConfig.adServer}/track`, JSON.stringify(data));
        }

        function trackGantaClick(adId) {
            const data = {
                type: 'click',
                adId: adId,
                clientId: gantaAdConfig.clientId,
                timestamp: new Date().toISOString(),
                url: window.location.href
            };
            
            navigator.sendBeacon(`${gantaAdConfig.adServer}/track`, JSON.stringify(data));
        }
    </script>
</body>
</html>
